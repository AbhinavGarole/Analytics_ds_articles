library(rpart)
library(knitr)
library(stargazer)
library(ggplot2)
data.train <- read.csv("/Users/suresh/Analytics_ds_articles/Missing_Value/data.train.csv")
dat1 <- read.csv("/Users/suresh/Analytics_ds_articles/Missing_Value/dat1.csv")
g <- ggplot(dat1, aes(x = x, y = y)) + geom_point(color = "blue")
g + ggtitle("(a)")
g + geom_smooth(method = 'lm', se = F, color = "black", formula = y ~ x) + ggtitle("(b)")
data.train.del <- data.train[!(is.na(data.train$Gender) | is.na(data.train$Transactions)),]
del <- lm(Revenue ~ Transactions + OS + Gender , data = data.train.del)
data.train.del <- data.train[!(is.na(data.train$Gender) | is.na(data.train$Transactions)),]
del <- lm(Revenue ~ Transactions + OS + Gender , data = data.train.del)
### Imputation by Average
data.train.avg <- data.train
mean.android <- mean(data.train.avg$Transactions[data.train.avg$OS == "Android"], na.rm = T)
mean.ios <- mean(data.train.avg$Transactions[data.train.avg$OS == "iOS"], na.rm = T)
data.train.avg[data.train.avg$OS == "Android" & is.na(data.train.avg$Transactions),]$Transactions <- mean.android
data.train.avg[data.train.avg$OS == "iOS" & is.na(data.train.avg$Transactions),]$Transactions <- mean.ios
data.train.avg$Gender[is.na(data.train.avg$Gender)] <- "Male"
avg <- lm(Revenue ~ Visits + Transactions + OS + Gender , data = data.train.avg)
### Imputation by Decision Tree and Linear regression
ind <- which(is.na(data.train$Gender))
dt <- rpart(Gender ~ Visits + Transactions + OS, data = data.train[-ind,], control = rpart.control(minsplit=2, cp=0.000001))
pred <- predict(dt, newdata = data.train[ind,], type = "class")
data.train.impute <- data.train
data.train.impute$Gender[ind] <- pred
ind.tr <- which(is.na(data.train$Transactions))
trans.lm <- lm(Transactions ~ Visits + OS + Gender, data = data.train.impute[-ind.tr,])
pred <- predict(trans.lm, newdata = data.train[ind.tr,])
data.train.impute$Transactions[ind.tr] <- pred
imp <- lm(Revenue ~ Transactions + OS + Gender, data = data.train.impute)
stargazer(del, avg, imp, type = 'html')
